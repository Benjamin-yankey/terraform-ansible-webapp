# Gitleaks configuration for secret detection

title = "Gitleaks config"

# Global options
[general]
verbose = true
regex = true
redact = true
max-depth = 0
exit-code = 1

# Rules for secret detection
[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = 'AKIA[0-9A-Z]{16}'
keywords = ["aws", "access", "key"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----'
keywords = ["private", "key", "rsa"]

[[rules]]
id = "api-key"
description = "API Key"
regex = '(api[_-]?key|apikey)\s*[=:]\s*[a-zA-Z0-9]{20,}'
keywords = ["api", "key"]

[[rules]]
id = "password-in-url"
description = "Password in URL"
regex = 'https?://[a-zA-Z0-9]+:[a-zA-Z0-9]+@'
keywords = ["password", "url"]

[[rules]]
id = "vault-password"
description = "Ansible Vault Password"
regex = '\$ANSIBLE_VAULT;\d\.\d;'
keywords = ["vault", "ansible"]
